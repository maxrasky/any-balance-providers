var g_headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","Accept-Language":"ru,en-US;q=0.8,en;q=0.6,uk;q=0.4",Connection:"keep-alive",Origin:"https://online.oschadbank.ua","User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.111 Safari/537.36"},baseurl="https://online.oschadbank.ua/",gDataJson;
function login(b,a){AnyBalance.setDefaultCharset("utf-8");checkEmpty(b.login,"Введіть логін!");checkEmpty(b.password,"Введіть пароль!");var d=AnyBalance.requestGet(baseurl+"wb/",g_headers);if(!/logout/i.test(d)){var e=getParam(d,null,null,/execution=([\s\S]{4})/i),c=getParam(d,null,null,/id="FORM_FAST_LOGIN"[^>]*action="\/([^"]*)/i);if(!c)throw AnyBalance.trace(d),new AnyBalance.Error("Не удалось найти ссылку на вход в кабинет, сайт изменен?");d=createFormParams(d,function(a,d,c,g){return"AUTH_METHOD"==
c?"FAST_PWA":"Login"==c?b.login:"password"==c?b.password:"_flowExecutionKey"==c?e:"_eventId"==c?"submitUserId":g});d=AnyBalance.requestPost(baseurl+c,d,addHeaders({Referer:baseurl+"wb/auth/userlogin?execution="+e}));AnyBalance.trace(baseurl+"wb/auth/userlogin?execution="+e);__setLoginSuccessful()}if(!/logout/i.test(d)){if(c=getParam(d,null,null,/Смена Пароля(?:[\s\S]*?<[^>]*>){2}([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,html_entity_decode))throw new AnyBalance.Error(c);(c=getElement(d,/<div[^>]+form-error[^>]*>/i))&&
(c=replaceAll(c,replaceTagsAndSpaces));if(c)throw new AnyBalance.Error(c,null,/неправильный логин или пароль/i.test(c));AnyBalance.trace(d);throw new AnyBalance.Error("Не вдалося зайти в особистий кабінет. Сайт змінено?");}return d}function processProfile(b,a){for(var d=getProductJson(),e=0;e<d.length;++e){var c=d[e];if(c.owner){a.profile={};getParam(c.owner.fullName,a.profile,"profile.fio");getParam(c.owner.itn,a.profile,"profile.itn");break}}}
function processCards(b,a){var d=getProductJson("card");AnyBalance.trace("Найдено карт: "+d.length);a.cards=[];for(var e=0;e<d.length;++e){var c=d[e],f=c.number,f={__id:c.id,__name:f,num:f};__shouldProcess("cards",f)&&processCard(c,f);a.cards.push(f)}}
function processCard(b,a){getParam(b.balances.available.value,a,"cards.balance",null,null,parseBalance);getParam(b.balances.full_crlimit.value,a,"cards.maxlimit",null,null,parseBalance);getParam(b.card.expiryDate+"",a,"cards.till",null,null,parseDate);getParam(b.balances.total_due.value,a,"cards.debt",null,null,parseBalance);getParam(b.balances["06"].value,a,"cards.mz",null,null,parseBalance);getParam(b.card.accountNumber,a,"cards.rr");getParam(b.balances.available.currency,a,["cards.currency","cards.balance",
"cards.maxlimit","cards.debt","cards.mz"]);getParam(b.number,a,"cards.cardNumber");"undefined"!=typeof processCardTransactions&&processCardTransactions(b,a)}function processAccounts(b,a){var d=getProductJson("cardAccount");AnyBalance.trace("Найдено счетов: "+d.length);a.accounts=[];for(var e=0;e<d.length;++e){var c=d[e],f=c.number,f={__id:c.id,__name:f,num:f};__shouldProcess("accounts",f)&&processAccount(c,f);a.accounts.push(f)}}
function processAccount(b,a){getParam(b.balances.available.value,a,"accounts.balance",null,null,parseBalance);getParam(b.balances.full_crlimit.value,a,"accounts.maxlimit",null,null,parseBalance);getParam(b.balances.total_due.value,a,"accounts.debt",null,null,parseBalance);getParam(b.balances["06"].value,a,"accounts.mz",null,null,parseBalance);getParam(b.cardAccount.accountNumber,a,"accounts.rr");getParam(b.balances.available.currency,a,["accounts.currency","accounts.balance","accounts.maxlimit","accounts.debt",
"accounts.mz"]);"undefined"!=typeof processAccountTransactions&&processAccountTransactions(b,a)}function getProductJson(b){if(gDataJson)a=gDataJson;else var a=AnyBalance.requestGet(baseurl+"wb/api/v1/contracts?system=W4C",addHeaders({"X-Requested-With":"XMLHttpRequest"})),a=gDataJson=getJson(a);return isset(b)?a.filter(function(a){return a.type==b}):a}function sortByKey(b,a){return b.sort(function(b,e){var c=b[a],f=e[a];return c>f?-1:c<f?1:0})};
